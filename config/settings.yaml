# AutoRedTeam-Orchestrator Configuration
# AI驱动的自动化红队渗透测试配置

# 通用设置
general:
  workspace: /tmp/redteam
  report_dir: ./reports
  log_dir: ./logs
  timeout: 300  # 单个工具默认超时(秒)

# 侦察阶段配置
recon:
  subfinder:
    threads: 50
    timeout: 180
    sources:
      - crtsh
      - hackertarget
      - threatcrowd
      - virustotal
  
  bruteforce:
    enabled: true
    wordlist: /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt
    threads: 100
  
  permutation:
    enabled: true
    max_base: 20  # 最多使用20个基础子域名

# 资产测绘配置
mapping:
  nmap:
    default_profile: standard  # quick/standard/full/stealth
    service_detection: true
    os_detection: false
    timing: T4
  
  httpx:
    threads: 50
    timeout: 30
    follow_redirects: true
    tech_detect: true

# 攻击阶段配置
attack:
  nuclei:
    severity: "critical,high,medium"
    rate_limit: 150
    concurrency: 50
    templates:
      - cves
      - vulnerabilities
      - exposures
      - misconfigurations
      - default-logins
    
    # 排除的模板
    exclude_templates:
      - dos
      - fuzzing
  
  # 每个目标最大扫描时间
  max_scan_time: 900

# 验证阶段配置
verify:
  # 自动过滤置信度低于此值的漏洞
  confidence_threshold: 0.4
  
  # 启用LLM辅助验证 (需要配置API)
  llm_enabled: false
  llm_provider: openai  # openai/anthropic/local
  llm_model: gpt-4

# AI决策引擎配置
ai_brain:
  # 高价值目标关键词
  high_value_keywords:
    - dev
    - test
    - staging
    - uat
    - admin
    - manage
    - api
    - internal
    - backend
    - dashboard
    - portal
    - vpn
    - git
    - jenkins
    - jira
    - confluence
    - gitlab
  
  # 优先级提升规则
  priority_boost:
    non_production: 3
    admin_panel: 2
    api_endpoint: 1

# 报告配置
report:
  format: json  # json/html/markdown
  include_evidence: true
  include_ai_decisions: true
  
# 安全设置
security:
  # 请求间隔(毫秒)，避免触发WAF
  request_delay: 100
  
  # 最大并发请求数
  max_concurrent: 50
  
  # User-Agent
  user_agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

# LLM API配置 (可选)
llm:
  openai:
    api_key: ""  # 从环境变量 OPENAI_API_KEY 读取
    model: gpt-4
    max_tokens: 2000
  
  anthropic:
    api_key: ""  # 从环境变量 ANTHROPIC_API_KEY 读取
    model: claude-3-sonnet-20240229
