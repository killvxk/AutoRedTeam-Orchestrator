#!/usr/bin/env python3
"""
漏洞利用模块 - Exploit Module
纯 Python 实现，无需外部工具依赖

提供:
- ExploitEngine: 自动漏洞利用引擎
- PureSQLiEngine: SQL注入利用引擎
- PurePortScanner: 端口扫描器
"""

# 导入利用器模块以触发注册
from . import exploiters

# 新增：自动化利用引擎
from .engine import (
    AccessInfo,
    BaseExploiter,
    ExploitEngine,
    ExploitResult,
    ExploitStatus,
    ExploitStrategyRegistry,
    ExploitType,
    FileInfo,
    ShellInfo,
    exploit_cve,
    exploit_vulnerability,
    register_exploiter,
)

# 新增：利用编排器
from .orchestrator import (
    ExploitOrchestrator,
    OrchestratedExploitResult,
    OrchestrationStrategy,
    RankedDetection,
    exploit_with_retry,
    orchestrate_exploits,
)
from .pure_scanner import (
    HostResult,
    PortResult,
    PortState,
    PurePortScanner,
    ServiceInfo,
    ServiceProbe,
    UDPScanner,
    quick_scan,
    scan_network,
    scan_ports,
)
from .pure_sqli import (
    DBType,
    InjectionPoint,
    PayloadGenerator,
    PureSQLiEngine,
    SQLiResult,
    SQLiType,
    WAFBypass,
    detect_sqli,
    exploit_sqli,
)

__all__ = [
    # ExploitEngine (新增)
    "ExploitEngine",
    "ExploitResult",
    "ExploitStatus",
    "ExploitType",
    "BaseExploiter",
    "ShellInfo",
    "AccessInfo",
    "FileInfo",
    "ExploitStrategyRegistry",
    "register_exploiter",
    "exploit_vulnerability",
    "exploit_cve",
    # SQLi Engine
    "PureSQLiEngine",
    "SQLiType",
    "SQLiResult",
    "DBType",
    "InjectionPoint",
    "PayloadGenerator",
    "WAFBypass",
    "detect_sqli",
    "exploit_sqli",
    # Port Scanner
    "PurePortScanner",
    "ServiceProbe",
    "PortState",
    "PortResult",
    "HostResult",
    "ServiceInfo",
    "UDPScanner",
    "scan_ports",
    "scan_network",
    "quick_scan",
    # Orchestrator (新增)
    "ExploitOrchestrator",
    "OrchestratedExploitResult",
    "OrchestrationStrategy",
    "RankedDetection",
    "orchestrate_exploits",
    "exploit_with_retry",
]
