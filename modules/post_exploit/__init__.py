"""
后渗透模块 - Post Exploitation Tools
"""

from typing import TYPE_CHECKING

from modules.post_exploit.enum_tools import LinEnumTool, WindowsEnumTool
from modules.post_exploit.privesc_tools import LinPEASTool, LinuxExploitSuggesterTool, WinPEASTool

# TYPE_CHECKING imports removed (legacy)


def register_post_tools(server: "MCPServer"):
    """注册后渗透工具"""
    tools = [
        LinPEASTool(),
        WinPEASTool(),
        LinuxExploitSuggesterTool(),
        LinEnumTool(),
        WindowsEnumTool(),
    ]

    for tool in tools:
        server.register_tool(tool)


__all__ = ["register_post_tools", "LinPEASTool", "WinPEASTool"]
